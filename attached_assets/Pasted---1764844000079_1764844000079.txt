Цель: ранги должны отображаться ровно такими, какими их посчитал сервер. Никаких клиентских перерасчётов и принудительной замены 0 на 1.

Бизнес-правило (фиксированное):
	•	Если у пользователя нет детей в структуре — его ранг = 0.
	•	Если под пользователем максимальная глубина структуры вниз = N уровней, его ранг = N.
	•	Пример цепочки A → B → C → D: D=0, C=1, B=2, A=3.

1. Убрать клиентский перерасчёт ранга в админке

В файле src/components/UsersManagementOptimized.tsx:
	1.	Найти и полностью удалить функции:
	•	calculateRankFromTree(...)
	•	recalculateAllRanksFromTree(...)
	2.	Удалить / переписать все места, где эти функции вызываются
(например, обработчики кнопки «Пересчитать ранги» в админке).

Вместо этого:
	•	Если нужна кнопка «Пересчитать ранги» — она должна:
	•	вызывать серверный эндпоинт пересчёта рангов (например, /admin/recalculate-all-ranks или тот, который уже есть в проекте),
	•	после успешного ответа перезапрашивать данные о пользователях и userRanks с сервера.
	•	Но не пересчитывать ранги по дереву на клиенте.

2. Исправить все || 1 для рангов

Нужно пройтись по файлам из аудита и:
	1.	Везде, где сейчас ранг подставляется так:
	•	user.уровень || user.level || 1
	•	currentUser?.уровень || 1
	•	и другие варианты с || 1,

заменить логику на:
	•	использовать ?? 0 как дефолт (разрешая ранг 0),
	•	либо брать значение из userRanks.get(userId) с дефолтом 0.

Конкретно:
	•	src/components/FilteredUsersList.tsx — заменить ... || 1 на корректный fallback ?? 0.
	•	src/components/MarketingToolsRu.tsx — то же самое для текущего пользователя.
	•	src/components/DashboardRu.tsx — убрать любые || 1 для уровня/ранга.
	•	src/components/UsersManagementOptimizedActions.tsx — убрать || 1 при отображении или работе с уровнем.

Правило: если данных о ранге нет — показываем 0. Никаких авто-“поднятий” до 1.

3. Чётко разделить «ранг» и «глубину узла дерева»

В src/components/StructureDataViz.tsx:
	1.	Сейчас используется node.глубина и выводится как «Уровень {node.глубина || 1}`.
	•	Это не тот ранг, который считает MLM-логика, это глубина визуального дерева.
	2.	Нужно:
	•	либо явно переименовать подпись в UI на что-то вроде «Глубина» (чтобы было понятно, что это не MLM-ранг),
	•	либо, если ты хочешь там показывать именно MLM-ранг, — использовать userRanks / user.уровень и не подменять 0 на 1.
	3.	В этом файле убрать || 1 при расчёте цвета и подписи (getAvatarColor(node.глубина || 1) и подобное) — заменить на ?? 0 или явный расчёт, который не поднимает ноль до единицы.

4. После изменений
	1.	Показать diff по затронутым файлам:
	•	UsersManagementOptimized.tsx
	•	FilteredUsersList.tsx
	•	MarketingToolsRu.tsx
	•	DashboardRu.tsx
	•	UsersManagementOptimizedActions.tsx
	•	StructureDataViz.tsx
	2.	Кратко описать:
	•	где именно был удалён клиентский пересчёт ранга,
	•	какие || 1 заменены и на что,
	•	что теперь используется как источник истины для отображения ранга (ожидаю: только данные с сервера / userRanks → user.уровень).

Важно: не менять серверную бизнес-логику рангов и не трогать расчёт комиссий. Только отображение и клиентский пересчёт ранга.