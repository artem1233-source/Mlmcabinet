# üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó: –ü–æ–ª–æ–º–∫–∞ —Å–≤—è–∑–µ–π –ø—Ä–∏ —Å–º–µ–Ω–µ ID

**–î–∞—Ç–∞:** 28 –Ω–æ—è–±—Ä—è 2024  
**–°—Ç–∞—Ç—É—Å:** üî¥ –¢–†–ï–ë–£–ï–¢–°–Ø –ù–ï–ú–ï–î–õ–ï–ù–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô

---

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –ß—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å?
–ü–æ—Å–ª–µ —Å–º–µ–Ω—ã ID —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. ‚ùå –°–ª–æ–º–∞–ª–æ—Å—å –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–º–∞–Ω–¥—ã
2. ‚ùå –°–ª–æ–º–∞–ª–∏—Å—å –≤—Å–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
3. ‚ùå –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

### –ü–æ—á–µ–º—É —Å–ª–æ–º–∞–ª–æ—Å—å?

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–≤ –∫–æ–¥ –≤ `/supabase/functions/server/index.tsx` (—Å—Ç—Ä–æ–∫–∏ 7161-7263), –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

#### ‚úÖ –ß—Ç–æ –†–ê–ë–û–¢–ê–ï–¢ –≤ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
```typescript
// –≠—Ç–∏ —á–∞—Å—Ç–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Å—Ç–∞—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚úÖ
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏ –Ω–æ–≤–æ–≥–æ ID ‚úÖ
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ sponsorId —É —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ ‚úÖ
4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ –∫–æ–º–∞–Ω–¥–∞ ‚úÖ
5. –ò–∑–º–µ–Ω–µ–Ω–∏–µ ID —Å–∞–º–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚úÖ
6. –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ ID ‚úÖ
```

#### ‚ùå –ß—Ç–æ –ù–ï –†–ê–ë–û–¢–ê–ï–¢ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã):

**–ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ1: –ù–µ–ø–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π**
```typescript
// –¢–µ–∫—É—â–∏–π –∫–æ–¥ (—Å—Ç—Ä–æ–∫–∏ 7204-7232)
for (const user of allUsers) {
  // –û–±–Ω–æ–≤–ª—è–µ—Ç sponsorId –∏ –∫–æ–º–∞–Ω–¥–∞
  // –ù–û! –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–ª—è –°–ê–ú–û–ì–û –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  if (needsUpdate && user.id !== oldId) {  // ‚ùå –û–®–ò–ë–ö–ê: –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç oldId!
    await kv.set(`user:id:${user.id}`, user);
  }
}
```

**–ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π**
```typescript
// –¢–µ–∫—É—â–∏–π –ø–æ—Ä—è–¥–æ–∫:
1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–µ–π –≤ –î–†–£–ì–ò–• –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö
2. –ò–∑–º–µ–Ω–µ–Ω–∏–µ ID —Å–∞–º–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–π –∑–∞–ø–∏—Å–∏

// ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –≤ —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥–µ –∏–ª–∏ –µ—Å—Ç—å —Ü–∏–∫–ª–∏—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏,
//              –æ–Ω–∏ –æ–±–Ω–æ–≤—è—Ç—Å—è –ü–û–°–õ–ï —Ç–æ–≥–æ –∫–∞–∫ –∑–∞–ø–∏—Å—å —É–∂–µ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞!
```

**–ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ3: –ù–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –∑–∞–∫–∞–∑–∞—Ö**
```typescript
// ‚ùå –û–¢–°–£–¢–°–¢–í–£–ï–¢: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –≤ –∑–∞–∫–∞–∑–∞—Ö
// –ó–∞–∫–∞–∑—ã —Å–æ–¥–µ—Ä–∂–∞—Ç:
// - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—åId (–∫—Ç–æ —Å–¥–µ–ª–∞–ª –∑–∞–∫–∞–∑)
// - d1_id, d2_id, d3_id (–∫—Ç–æ –ø–æ–ª—É—á–∏—Ç –∫–æ–º–∏—Å—Å–∏–∏)

// –≠—Ç–∏ –ø–æ–ª—è –ù–ï –û–ë–ù–û–í–õ–Ø–Æ–¢–°–Ø!
```

**–ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ4: –ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç–∏**
```typescript
// ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—è –ø—Ä–µ—Ä–≤—ë—Ç—Å—è –ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ,
//              –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –≤ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
```

**–ü—Ä–æ–±–ª–µ–º–∞ ‚Ññ5: –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π**
```typescript
// ‚ùå –û–¢–°–£–¢–°–¢–í–£–ï–¢: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
```

---

## üìã –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### üéØ –°–¢–†–ê–¢–ï–ì–ò–Ø 1: –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–ù–ï–ú–ï–î–õ–ï–ù–ù–û)

**–¶–µ–ª—å:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –°–ï–ô–ß–ê–°, –Ω–µ —Ç—Ä–æ–≥–∞—è —Å–ª–æ–º–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é

**–®–∞–≥–∏:**
1. –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É "Data Recovery Tool"
2. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ë–î
3. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –¥–µ—Ä–µ–≤–æ —Å–≤—è–∑–µ–π
4. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤—è–∑–∏ –≤—Ä—É—á–Ω—É—é

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (15-30 –º–∏–Ω—É—Ç —Ä–∞–±–æ—Ç—ã)
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞
- ‚úÖ –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
- ‚úÖ –î–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ù–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- ‚ùå –¢—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –ú–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ —Å–µ—Ä—å—ë–∑–Ω—ã—Ö –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è—Ö

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 30-60 –º–∏–Ω—É—Ç  
**–†–∏—Å–∫:** –ù–ò–ó–ö–ò–ô  
**–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –í–´–°–û–ö–ê–Ø –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏

---

### üîß –°–¢–†–ê–¢–ï–ì–ò–Ø 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ changeUserId (–ü–†–û–§–ò–õ–ê–ö–¢–ò–ö–ê)

**–¶–µ–ª—å:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥, —á—Ç–æ–±—ã –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–ª–∞—Å—å

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `/supabase/functions/server/index.tsx`:**

```typescript
// ‚úÖ –£–õ–£–ß–®–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø changeUserId

app.post('/make-server-05aa3c8a/admin/change-user-id', async (c) => {
  try {
    const userId = c.req.header('X-User-Id');
    const currentUser = await verifyUser(userId);
    await requireAdmin(c, currentUser);

    const body = await c.req.json();
    const { oldId, newId } = body;

    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if (!oldId || !newId) {
      return c.json({ success: false, error: '–ù–µ —É–∫–∞–∑–∞–Ω—ã oldId –∏–ª–∏ newId' }, 400);
    }
    if (oldId === newId) {
      return c.json({ success: false, error: '–°—Ç–∞—Ä—ã–π –∏ –Ω–æ–≤—ã–π ID —Å–æ–≤–ø–∞–¥–∞—é—Ç' }, 400);
    }

    console.log(`üîÑ Changing user ID: ${oldId} ‚Üí ${newId}`);

    // 1Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è
    const oldUser = await kv.get(`user:id:${oldId}`);
    if (!oldUser) {
      return c.json({ success: false, error: `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${oldId} –Ω–µ –Ω–∞–π–¥–µ–Ω` }, 404);
    }

    const existingUser = await kv.get(`user:id:${newId}`);
    if (existingUser) {
      return c.json({ success: false, error: `ID ${newId} —É–∂–µ –∑–∞–Ω—è—Ç` }, 400);
    }

    // 2Ô∏è‚É£ –ü–æ–ª—É—á–∞–µ–º –í–°–ï –¥–∞–Ω–Ω—ã–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ + –∑–∞–∫–∞–∑—ã)
    const allUsers = await kv.getByPrefix('user:id:');
    const allOrders = await kv.getByPrefix('order:');
    console.log(`üìã Loaded ${allUsers.length} users, ${allOrders.length} orders`);

    // 3Ô∏è‚É£ –°–û–ó–î–ê–Å–ú –°–ù–ò–ú–û–ö –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –æ—Ç–∫–∞—Ç–∞
    const snapshot = {
      users: JSON.parse(JSON.stringify(allUsers)),
      orders: JSON.parse(JSON.stringify(allOrders)),
      timestamp: new Date().toISOString()
    };
    await kv.set(`snapshot:change-id:${oldId}:${Date.now()}`, snapshot);
    console.log('üì∏ Created backup snapshot');

    let updatedUsers = 0;
    let updatedOrders = 0;
    const updateLog: string[] = [];

    // 4Ô∏è‚É£ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –≤–æ –í–°–ï–• –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö (–≤–∫–ª—é—á–∞—è —Å–∞–º–æ–≥–æ —Å–µ–±—è!)
    for (const user of allUsers) {
      let needsUpdate = false;
      const originalUser = JSON.stringify(user);

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ sponsorId
      if (user.—Å–ø–æ–Ω—Å–æ—ÄId === oldId) {
        console.log(`üîß [User ${user.id}] sponsorId: ${oldId} ‚Üí ${newId}`);
        user.—Å–ø–æ–Ω—Å–æ—ÄId = newId;
        needsUpdate = true;
        updateLog.push(`User ${user.id}: sponsorId updated`);
      }

      // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ –∫–æ–º–∞–Ω–¥–∞
      if (user.–∫–æ–º–∞–Ω–¥–∞ && Array.isArray(user.–∫–æ–º–∞–Ω–¥–∞)) {
        const indexToUpdate = user.–∫–æ–º–∞–Ω–¥–∞.indexOf(oldId);
        if (indexToUpdate !== -1) {
          console.log(`üîß [User ${user.id}] –∫–æ–º–∞–Ω–¥–∞: replacing ${oldId} with ${newId} at index ${indexToUpdate}`);
          user.–∫–æ–º–∞–Ω–¥–∞[indexToUpdate] = newId;
          needsUpdate = true;
          updateLog.push(`User ${user.id}: –∫–æ–º–∞–Ω–¥–∞ updated`);
        }
      }

      // ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –°–æ—Ö—Ä–∞–Ω—è–µ–º –í–°–ï –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ (—É–±–∏—Ä–∞–µ–º —Ñ–∏–ª—å—Ç—Ä user.id !== oldId)
      if (needsUpdate) {
        await kv.set(`user:id:${user.id}`, user);
        updatedUsers++;
      }
    }

    // 5Ô∏è‚É£ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –≤ –ó–ê–ö–ê–ó–ê–•
    for (const order of allOrders) {
      let needsUpdate = false;

      // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—åId
      if (order.–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—åId === oldId) {
        console.log(`üîß [Order ${order.id}] –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—åId: ${oldId} ‚Üí ${newId}`);
        order.–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—åId = newId;
        needsUpdate = true;
        updateLog.push(`Order ${order.id}: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—åId updated`);
      }

      // –û–±–Ω–æ–≤–ª—è–µ–º d1_id, d2_id, d3_id (–∫–æ–º–∏—Å—Å–∏–∏)
      if (order.d1_id === oldId) {
        order.d1_id = newId;
        needsUpdate = true;
        updateLog.push(`Order ${order.id}: d1_id updated`);
      }
      if (order.d2_id === oldId) {
        order.d2_id = newId;
        needsUpdate = true;
        updateLog.push(`Order ${order.id}: d2_id updated`);
      }
      if (order.d3_id === oldId) {
        order.d3_id = newId;
        needsUpdate = true;
        updateLog.push(`Order ${order.id}: d3_id updated`);
      }

      if (needsUpdate) {
        await kv.set(order._key || `order:${order.id}`, order);
        updatedOrders++;
      }
    }

    // 6Ô∏è‚É£ –û–±–Ω–æ–≤–ª—è–µ–º ID —Å–∞–º–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ò —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–¥ –Ω–æ–≤—ã–º –∫–ª—é—á–æ–º
    oldUser.id = newId;
    await kv.set(`user:id:${newId}`, oldUser);
    console.log(`‚úÖ Created new user record: user:id:${newId}`);
    
    // 7Ô∏è‚É£ –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –∑–∞–ø–∏—Å—å
    await kv.del(`user:id:${oldId}`);
    console.log(`üóëÔ∏è Deleted old user record: user:id:${oldId}`);
    
    // 8Ô∏è‚É£ –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º —Å—Ç–∞—Ä—ã–π ID –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    if (oldId.length === 3 && /^\d+$/.test(oldId)) {
      await freePartnerId(oldId);
      console.log(`‚ôªÔ∏è Freed old partner ID ${oldId}`);
    } else {
      await freeUserId(oldId);
      console.log(`‚ôªÔ∏è Freed old user ID ${oldId}`);
    }

    // 9Ô∏è‚É£ –í–ê–õ–ò–î–ê–¶–ò–Ø: –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    const validationErrors: string[] = [];
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const updatedUser = await kv.get(`user:id:${newId}`);
    if (!updatedUser) {
      validationErrors.push(`‚ùå User ${newId} not found after update`);
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å—Ç–∞—Ä–æ–≥–æ –Ω–µ—Ç
    const deletedUser = await kv.get(`user:id:${oldId}`);
    if (deletedUser) {
      validationErrors.push(`‚ùå Old user ${oldId} still exists!`);
    }
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –Ω–∏–∫—Ç–æ –Ω–µ —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç–∞—Ä—ã–π ID
    const allUsersAfter = await kv.getByPrefix('user:id:');
    for (const user of allUsersAfter) {
      if (user.—Å–ø–æ–Ω—Å–æ—ÄId === oldId) {
        validationErrors.push(`‚ùå User ${user.id} still has sponsorId=${oldId}`);
      }
      if (user.–∫–æ–º–∞–Ω–¥–∞ && user.–∫–æ–º–∞–Ω–¥–∞.includes(oldId)) {
        validationErrors.push(`‚ùå User ${user.id} still has ${oldId} in –∫–æ–º–∞–Ω–¥–∞`);
      }
    }

    if (validationErrors.length > 0) {
      console.error('‚ùå VALIDATION FAILED:', validationErrors);
      // –í –∏–¥–µ–∞–ª–µ –∑–¥–µ—Å—å –Ω—É–∂–µ–Ω –æ—Ç–∫–∞—Ç, –Ω–æ —ç—Ç–æ —Å–ª–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å
      return c.json({
        success: false,
        error: 'Validation failed after update',
        validationErrors,
        message: '–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã, –Ω–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è. –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞!'
      }, 500);
    }

    // üîü –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ–º –≤—Å–µ –∫—ç—à–∏
    await invalidateUsersCache();
    await metricsCache.invalidateAllCache();
    await invalidateRankCache();

    console.log(`‚úÖ User ID changed successfully: ${oldId} ‚Üí ${newId}`);
    console.log(`üìä Updated ${updatedUsers} users, ${updatedOrders} orders`);

    return c.json({
      success: true,
      message: `ID –∏–∑–º–µ–Ω—ë–Ω: ${oldId} ‚Üí ${newId}`,
      stats: {
        updatedUsers,
        updatedOrders,
        totalReferences: updatedUsers + updatedOrders
      },
      log: updateLog
    });

  } catch (error) {
    console.error('‚ùå Error changing user ID:', error);
    return c.json({ 
      success: false, 
      error: String(error),
      message: '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞.'
    }, 500);
  }
});
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü–æ–ª–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫ (users + orders)
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–∞ –¥–ª—è –æ—Ç–∫–∞—Ç–∞
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∫–æ–¥–∞
- ‚ùå –ù—É–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
- ‚ùå –ù–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –£–ñ–ï —Å–ª–æ–º–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 1-2 —á–∞—Å–∞  
**–†–∏—Å–∫:** –°–†–ï–î–ù–ò–ô (–Ω—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)  
**–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –û–ß–ï–ù–¨ –í–´–°–û–ö–ê–Ø –¥–ª—è –±—É–¥—É—â–µ–≥–æ

---

### üõ†Ô∏è –°–¢–†–ê–¢–ï–ì–ò–Ø 3: –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è + –ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω—ã–µ –º–µ—Ä—ã

**–¶–µ–ª—å:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –°–ï–ô–ß–ê–° + –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –≤ –±—É–¥—É—â–µ–º

**–ß–∞—Å—Ç—å 1: –°–æ–∑–¥–∞–Ω–∏–µ Recovery Tool (frontend)**
```typescript
// /components/admin/DataRecoveryTool.tsx
// –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–ª–æ–º–∞–Ω–Ω—ã—Ö —Å–≤—è–∑–µ–π
```

**–ß–∞—Å—Ç—å 2: –£–ª—É—á—à–µ–Ω–∏–µ changeUserId (backend)**
```typescript
// –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑ –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ 2
```

**–ß–∞—Å—Ç—å 3: –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π**
```typescript
// –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∫—Ä–∏—Ç–∏—á–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
// –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –†–µ—à–∞–µ—Ç —Ç–µ–∫—É—â—É—é –ø—Ä–æ–±–ª–µ–º—É
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –±—É–¥—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- ‚úÖ –î–æ–±–∞–≤–ª—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- ‚úÖ –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –°–∞–º–∞—è —Ç—Ä—É–¥–æ—ë–º–∫–∞—è (3-4 —á–∞—Å–∞)
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π frontend + backend

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 3-4 —á–∞—Å–∞  
**–†–∏—Å–∫:** –ù–ò–ó–ö–ò–ô (–ø–æ—ç—Ç–∞–ø–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)  
**–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–ê–Ø

---

### üîÑ –°–¢–†–ê–¢–ï–ì–ò–Ø 4: –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π (–µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ)

**–¶–µ–ª—å:** –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞

**–£—Å–ª–æ–≤–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:**
- –ï—Å–ª–∏ –µ—Å—Ç—å –±—ç–∫–∞–ø –¥–∞–Ω–Ω—ã—Ö –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è ID
- –ï—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ ID –±—ã–ª–æ –Ω–µ–¥–∞–≤–Ω–æ (<24 —á–∞—Å–∞)
- –ï—Å–ª–∏ –Ω–µ—Ç –¥—Ä—É–≥–∏—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ

**–®–∞–≥–∏:**
1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –±—ç–∫–∞–ø–∞
2. –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –°–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± (–µ—Å–ª–∏ –µ—Å—Ç—å –±—ç–∫–∞–ø)
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫
- ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –¢—Ä–µ–±—É–µ—Ç –Ω–∞–ª–∏—á–∏–µ –±—ç–∫–∞–ø–∞
- ‚ùå –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –±—ç–∫–∞–ø–∞
- ‚ùå –ù–µ —Ä–µ—à–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 10-30 –º–∏–Ω—É—Ç (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –±—ç–∫–∞–ø–∞)  
**–†–∏—Å–∫:** –ù–ò–ó–ö–ò–ô  
**–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–ª–∏—á–∏—è –±—ç–∫–∞–ø–∞

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ô –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### ‚ö° –§–ê–ó–ê 1: –≠–ö–°–¢–†–ï–ù–ù–û–ï –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï (–°–ï–ô–ß–ê–°)

**–¶–µ–ª—å:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∑–∞ 1-2 —á–∞—Å–∞

**–î–µ–π—Å—Ç–≤–∏—è:**
1. ‚úÖ **–°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É Data Recovery Tool** (30 –º–∏–Ω—É—Ç)
   - –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
   - –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã —Å–≤—è–∑–µ–π
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

2. ‚úÖ **–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É** (5 –º–∏–Ω—É—Ç)
   - –ù–∞–π—Ç–∏ –≤—Å–µ —Å–ª–æ–º–∞–Ω–Ω—ã–µ —Å–≤—è–∑–∏
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–∞—Å—à—Ç–∞–± –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π

3. ‚úÖ **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤—è–∑–∏** (15-30 –º–∏–Ω—É—Ç)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
   - –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–≤—è–∑–µ–π

4. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã** (10 –º–∏–Ω—É—Ç)
   - –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å—á—ë—Ç —Ä–∞–Ω–≥–æ–≤

### üîß –§–ê–ó–ê 2: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –§–£–ù–ö–¶–ò–ò (–ü–û–°–õ–ï –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø)

**–¶–µ–ª—å:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**–î–µ–π—Å—Ç–≤–∏—è:**
1. ‚úÖ **–£–ª—É—á—à–∏—Ç—å changeUserId –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** (1-2 —á–∞—Å–∞)
   - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑ –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ 2
   - –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –∏ —Å–Ω–∏–º–∫–∏
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –≤ –∑–∞–∫–∞–∑–∞—Ö

2. ‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö** (30 –º–∏–Ω—É—Ç)
   - –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ò–∑–º–µ–Ω–∏—Ç—å ID
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å–≤—è–∑–∏

3. ‚úÖ **–î–µ–ø–ª–æ–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏** (15 –º–∏–Ω—É—Ç)

### üõ°Ô∏è –§–ê–ó–ê 3: –ü–†–ï–í–ï–ù–¢–ò–í–ù–´–ï –ú–ï–†–´ (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –ø–æ–¥–æ–±–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

**–î–µ–π—Å—Ç–≤–∏—è:**
1. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** (1 —á–∞—Å)
   - –†–µ–≥—É–ª—è—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º

2. ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –±—ç–∫–∞–ø–æ–≤** (30 –º–∏–Ω—É—Ç)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–∏–º–∫–æ–≤ –ø–µ—Ä–µ–¥ –∫—Ä–∏—Ç–∏—á–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞

3. ‚úÖ **–£–ª—É—á—à–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è** (30 –º–∏–Ω—É—Ç)
   - –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è—Ö –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

---

## üí° –ö–ê–ö–£–Æ –°–¢–†–ê–¢–ï–ì–ò–Æ –í–´–ë–†–ê–¢–¨?

### üèÜ –û–ü–¢–ò–ú–ê–õ–¨–ù–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è (1 + 2)

**–ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π:**

1. **–°–ï–ô–ß–ê–°:** –ó–∞–ø—É—Å—Ç–∏—Ç—å –°—Ç—Ä–∞—Ç–µ–≥–∏—é 1 (Recovery Tool)
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
   - –í—Ä–µ–º—è: 1-2 —á–∞—Å–∞
   - –†–∏—Å–∫: –ù–ò–ó–ö–ò–ô

2. **–ü–û–¢–û–ú:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å –°—Ç—Ä–∞—Ç–µ–≥–∏—é 2 (Fix changeUserId)
   - –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   - –í—Ä–µ–º—è: 1-2 —á–∞—Å–∞
   - –†–∏—Å–∫: –°–†–ï–î–ù–ò–ô

**–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —ç—Ç–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è:**
- ‚úÖ –†–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –°–ï–ô–ß–ê–° (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –≤ –ë–£–î–£–©–ï–ú (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
- ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏/—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- ‚úÖ –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫ (–ø–æ—ç—Ç–∞–ø–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ)
- ‚úÖ –ü–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –°—Ç—Ä–∞—Ç–µ–≥–∏—è 1<br/>(Recovery) | –°—Ç—Ä–∞—Ç–µ–≥–∏—è 2<br/>(Fix) | –°—Ç—Ä–∞—Ç–µ–≥–∏—è 3<br/>(–ö–æ–º–ø–ª–µ–∫—Å) | –°—Ç—Ä–∞—Ç–µ–≥–∏—è 4<br/>(–û—Ç–∫–∞—Ç) |
|----------|------------------------|-------------------|---------------------|---------------------|
| **–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** | 1-2 —á–∞—Å–∞ | 1-2 —á–∞—Å–∞ | 3-4 —á–∞—Å–∞ | 10-30 –º–∏–Ω |
| **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** | ‚úÖ –î–ê | ‚ùå –ù–ï–¢ | ‚úÖ –î–ê | ‚úÖ –î–ê* |
| **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è** | ‚ùå –ù–ï–¢ | ‚úÖ –î–ê | ‚úÖ –î–ê | ‚ùå –ù–ï–¢ |
| **–†–∏—Å–∫** | üü¢ –ù–∏–∑–∫–∏–π | üü° –°—Ä–µ–¥–Ω–∏–π | üü¢ –ù–∏–∑–∫–∏–π | üü¢ –ù–∏–∑–∫–∏–π |
| **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** | üü° –°—Ä–µ–¥–Ω—è—è | üü¢ –í—ã—Å–æ–∫–∞—è | üü¢ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è | üü° –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –±—ç–∫–∞–ø–∞ |
| **–¢—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è backend** | ‚ùå –ù–ï–¢ | ‚úÖ –î–ê | ‚úÖ –î–ê | ‚ùå –ù–ï–¢ |
| **–ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è** | ‚úÖ –î–ê | ‚ùå –ù–ï–¢ | ‚ùå –ù–ï–¢ | ‚úÖ –î–ê* |

*—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –±—ç–∫–∞–ø–∞

---

## üöÄ –ù–ï–ú–ï–î–õ–ï–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°:**

1. ‚úÖ **–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:**
   - –†–µ–∫–æ–º–µ–Ω–¥—É—é: –°—Ç—Ä–∞—Ç–µ–≥–∏—è 1 (Recovery) ‚Üí –°—Ç—Ä–∞—Ç–µ–≥–∏—è 2 (Fix)
   - –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –°—Ç—Ä–∞—Ç–µ–≥–∏—è 4 (–û—Ç–∫–∞—Ç), –µ—Å–ª–∏ –µ—Å—Ç—å –±—ç–∫–∞–ø

2. ‚úÖ **–î–∞–π—Ç–µ –º–Ω–µ –∫–æ–º–∞–Ω–¥—É:**
   - "–ù–∞—á–∏–Ω–∞–π –°—Ç—Ä–∞—Ç–µ–≥–∏—é 1" ‚Üí –°–æ–∑–¥–∞–º Recovery Tool
   - "–ù–∞—á–∏–Ω–∞–π –°—Ç—Ä–∞—Ç–µ–≥–∏—é 2" ‚Üí –ò—Å–ø—Ä–∞–≤–ª—é changeUserId
   - "–ù–∞—á–∏–Ω–∞–π –°—Ç—Ä–∞—Ç–µ–≥–∏—é 3" ‚Üí –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
   - "–ï—Å—Ç—å –±—ç–∫–∞–ø, –Ω—É–∂–µ–Ω –æ—Ç–∫–∞—Ç" ‚Üí –ü–æ–º–æ–≥—É —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º

3. ‚úÖ **–ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:**
   - –ö–∞–∫–æ–π ID –±—ã–ª –∏–∑–º–µ–Ω—ë–Ω? (oldId ‚Üí newId)
   - –ö–æ–≥–¥–∞ –ø—Ä–æ–∏–∑–æ—à–ª–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ?
   - –ï—Å—Ç—å –ª–∏ –±—ç–∫–∞–ø –¥–∞–Ω–Ω—ã—Ö?
   - –ù–∞—Å–∫–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω–∞ —Å–∏—Ç—É–∞—Ü–∏—è?

---

## üìû –ì–æ—Ç–æ–≤ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É!

**–ñ–¥—É –≤–∞—à–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è, –∫–∞–∫—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø—Ä–∏–º–µ–Ω–∏—Ç—å.**

**–ú–æ–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. üèÜ **–õ–£–ß–®–ò–ô –í–ê–†–ò–ê–ù–¢:** –°—Ç—Ä–∞—Ç–µ–≥–∏—è 1 (—Å–µ–π—á–∞—Å) ‚Üí –°—Ç—Ä–∞—Ç–µ–≥–∏—è 2 (–ø–æ—Ç–æ–º)
2. ü•à **–ë–´–°–¢–†–´–ô –í–ê–†–ò–ê–ù–¢:** –°—Ç—Ä–∞—Ç–µ–≥–∏—è 4 (–æ—Ç–∫–∞—Ç, –µ—Å–ª–∏ –µ—Å—Ç—å –±—ç–∫–∞–ø)
3. ü•â **–î–û–õ–ì–û–°–†–û–ß–ù–´–ô –í–ê–†–ò–ê–ù–¢:** –°—Ç—Ä–∞—Ç–µ–≥–∏—è 3 (–∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)

**–°–∫–∞–∂–∏—Ç–µ "–ù–∞—á–∏–Ω–∞–π –°—Ç—Ä–∞—Ç–µ–≥–∏—é [–Ω–æ–º–µ—Ä]" –∏ —è –ø—Ä–∏—Å—Ç—É–ø–∞—é –∫ —Ä–∞–±–æ—Ç–µ!** üöÄ
